<project name="bootstrap.main">

	<path id="main.classpath">
		<fileset dir="bin/lib/main/jars" includes="*.jar"/>
	</path>

	<target name="main.compile" depends="ivy.retrieve" description="compile src/main">
		<mkdir dir="bin/main"/>
		<javac srcdir="src/main" destdir="bin/main" classpathref="main.classpath" debug="true" nowarn="yes" source="1.5" target="1.5" encoding="utf8"/>
	</target>

	<target name="main.jar" depends="main.compile" description="create joist-bootstrap.jar">
		<mkdir dir="bin/jars"/>
		<manifest file="bin/MANIFEST.MF">
			<attribute name="Built-By" value="${user.name}"/>
			<attribute name="Main-Class" value="joist.Bootstrap"/>
		</manifest>
		<jar destfile="bin/jars/joist-bootstrap.jar" manifest="bin/MANIFEST.MF">
			<fileset dir="bin/main" includes="**/*.class"/>
			<zipfileset dir="src/templates" includes="**/*" prefix="templates/"/>
			<zipfileset src="bin/lib/main/jars/joist-util.jar" includes="joist/util/**/*.class"/>
		</jar>
		<mkdir dir="bin/sources"/>
		<zip destfile="bin/sources/joist-bootstrap.jar">
			<fileset dir="src/main" includes="**/*.java"/>
		</zip>
	</target>

</project>
