<project name="unit">

	<path id="unit.classpath">
		<pathelement path="bin/main"/>
		<fileset dir="bin/unit.lib" includes="*.jar"/>
	</path>

	<target name="unit.compile" depends="main.compile" description="compile tests/unit">
		<mkdir dir="bin/tests/unit"/>
		<javac srcdir="tests/unit" destdir="bin/tests/unit" classpathref="unit.classpath" debug="true" nowarn="yes" source="1.5" target="1.5" encoding="utf8"/>
	</target>

	<target name="unit.run" depends="unit.compile" description="run tests/unit">
		<mkdir dir="bin/results/unit"/>
		<junit printsummary="on" showoutput="yes" failureproperty="test-suite-failed" fork="yes" forkmode="once">
			<!--
			<jvmarg value="-Xdebug"/>
			<jvmarg value="-Xnoagent"/>
			<jvmarg value="-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000"/>
			<jvmarg value="-agentlib:yjpagent"/>
			-->
			<classpath>
				<pathelement path="bin/tests/unit"/>
				<path refid="unit.classpath"/>
			</classpath>
			<formatter type="xml"/>
			<batchtest todir="bin/results/unit">
				<fileset dir="tests/unit" includes="**/*Test.java" excludes="**/Abstract*.java"/>
			</batchtest>
		</junit>
		<fail if="test-suite-failed">unit tests failed</fail>
	</target>

</project>

